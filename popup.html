<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Pop-Up Blocker Popup</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <h2 style="white-space: pre-wrap; overflow-wrap: break-word; margin-top: -1rem; text-align: center;" id="title">Excel Online<br>Pop-Up Blocker</h2>
    <div class="section">This Extension suppresses annoying pop-ups in Excel Online.
        <div class="info-container" id="intro-hoverable">
            <div class="hoverable">ðŸ›ˆ</div>
            <div class="tooltip" id="intro-tooltip">Only dialogs contained in iframes with origin containing "https://*.<wbr>officeapps.<wbr>live.<wbr>com/" are suppressed.<br>To expand functionality to the overall page or to additional origins, please contact the developer.</div>
        </div>
    </div>
    <p>Select which pop-ups to block below!<br>Any modifications to the Excel Online experience are made solely at the user's discretion. Please use responsibly.</p>
    




    <div class="section 1" id="blocked-pop-ups">
        <h3>Block Pop-Ups</h3>
        <!-- <div class="row" id="row-1-1">
            <label for="checkbox-1-1">
                <input type="checkbox" id="checkbox-1-1" style="margin-right: 0.5rem">Calendar Pop-Up
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">This calendar blocks view of everything to the right of the current cell.<br>This pop-up appears when pressing Ctrl+; in Excel Online.<br><br>Check to block the pop-up.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-1-2">
            <label for="checkbox-1-2">
                <input type="checkbox" id="checkbox-1-2" style="margin-right: 0.5rem">Renaming Prompt
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'We have autosaved your file. Ready to name it?'<br>This pop-up sometimes appears when pressing Ctrl+S in Excel Online.<br><br>Check to block the pop-up.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-1-3">
            <label for="checkbox-1-3">
                <input type="checkbox" id="checkbox-1-3" style="margin-right: 0.5rem">Need More Working Space? Pop-Up
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Need more working space?'<br>'Looks like your display is not optimised.'<br>'Toggle FullScreen to maximise screen space.'<br>This pop-up sometimes appears when the window is smaller.<br><br>Check to block the pop-up.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-1-4">
            <label for="checkbox-1-4">
                <input type="checkbox" id="checkbox-1-4" style="margin-right: 0.5rem">Reserved Shortcut Pop-Up
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Your browser reserves some shortcuts.'<br>'Find the list of alternatives here.'<br>This pop-up sometimes appears when using hotkeys in Excel Online.<br><br>Check to block the pop-up.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-1-5">
            <label for="checkbox-1-5">
                <input type="checkbox" id="checkbox-1-5" style="margin-right: 0.5rem">Ctrl Paste Menu
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">Paste options menu that opens when pressing Ctrl.<br>This pop-up appears after pasting.<br><br>Check to block the pop-up.</div>
                </div>
            </label>
        </div> -->
    </div>




















    <div class="section 2" id="auto-approved-pop-ups">
        <h3>Auto-Approve Pop-Ups</h3>
        <!-- <div class="row" id="row-2-1">
            <label for="checkbox-2-1">
                <input type="checkbox" id="checkbox-2-1" style="margin-right: 0.5rem">Workbook Locked
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Someone has this workbook locked'<br>'_ has locked this file for editing. This may happen if they're using a non-subscription version of Excel. Ask them to close the file or check it in.'<br><br>Check to auto-select 'Continue in reading view'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-2-2">
            <label for="checkbox-2-2">
                <input type="checkbox" id="checkbox-2-2" style="margin-right: 0.5rem">Frozen Rows Won't Scroll
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Frozen rows won't scroll'<br>'The visible area of your grid contains only frozen rows, which will not scroll. To scroll, unfreeze the rows, change the size of the Excel window, or zoom out.'<br>This pop-up appears when trying to scroll on a screen with no unfrozen cells visible.<br><br>Check to auto-select 'OK'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-2-3">
            <label for="checkbox-2-3">
                <input type="checkbox" id="checkbox-2-3" style="margin-right: 0.5rem">Editing Session in Progress
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Editing session in progress'<br>'Other people are already editing this workbook. You can join their editing session, but you will lose any changes you have made so far. Would you like to join the existing editing session anyway?'<br><br>Check to auto-select 'Yes'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-2-4">
            <label for="checkbox-2-4">
                <input type="checkbox" id="checkbox-2-4" style="margin-right: 0.5rem">Session About to Expire
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Your session is about to expire'<br>'Your organization's policy enforces automatic sign out after a period of inactivity on Office 365 web applications.'<br>'Do you want to stay signed in?'<br><br>Check to auto-select 'Stay signed in'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-2-5">
            <label for="checkbox-2-5">
                <input type="checkbox" id="checkbox-2-5" style="margin-right: 0.5rem">Session Expired
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Sorry, your session has expired. Please refresh the page to continue.'<br><br>Check to auto-select 'Refresh'.</div>
                </div>
            </label>
        </div> -->
        <!-- <div class="row" id="addl-row-2-1">
            <label for="addl-checkbox-2-1">
                <input type="checkbox" id="addl-checkbox-2-1" style="margin-right: 0.5rem">New Name
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">Pop-Up Text: 'Example inputted pop-up text'<br><br>Check to auto-select Button Label: 'Example inputted button label'.</div>
                </div>
            </label>
            <button class="delete-button" id="delete-row-2-1">&times;</button>
        </div> -->
        <div class="row" id="new-row-2" style="display: flexbox; float:left;">
            <button id="new-save-button-2" class="add-button" title="Save New Row">+</button>
            <input type="text" id="new-name-2" placeholder="Name" style="width:15%">
            <input type="text" id="new-text-2" placeholder="Pop-Up Text" style="width:28%">
            <input type="text" id="new-label-2" placeholder="Button Label" style="width:28%">
            <div class="info-container">
                <div class="hoverable">ðŸ›ˆ</div>
                <div class="tooltip">Name: Input the name you would like to label this item as.<br><br>Pop-Up Text: Text which is visible on the pop-up. The extension will look for this text as an indication that the pop-up has appeared.<br><br>Button Label: Exact text on the button that will be automatically clicked. The extension will look for a button with aria-label matching this. Most X's have aria-label="Close".<br><br>Saving: Press Enter to save, or press the "+" button to the left of your entry.</div>
            </div>
            <button class="delete-button" id="cancel-new-row-2">&times;</button>
        </div>
        <div class="row" id="add-row-2">
            <label for="add-button-2" class="add-label">
                <button id="add-button-2" class="add-button" title="Add New Row" style="margin-right: 0.5rem">+</button>Add New Row
            </label>
        </div>
    </div>



    



    <div class="section 3" id="auto-closed-pop-ups">
        <h3>Auto-Close Pop-Ups</h3>
        <!-- <div class="row" id="row-3-1">
            <label for="checkbox-3-1">
                <input type="checkbox" id="checkbox-3-1" style="margin-right: 0.5rem">Can't Edit Workbook Dialog
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Can't Edit Workbook'<br>'Someone has this workbook locked'<br>'We're sorry. We couldn't lock this file for editing. Would you like to try again?'<br>This pop-up sometimes appears when trying to change to Editing mode.<br><br>Check to auto-select 'No'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-3-2">
            <label for="checkbox-3-2">
                <input type="checkbox" id="checkbox-3-2" style="margin-right: 0.5rem">Trust Workbook Links Banner
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Trust workbook links? This workbook links to data in external workbooks.'<br>This pop-up appears when external workbooks are referenced.<br><br>Check to auto-close (ignore and close the dialog).</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-3-3">
            <label for="checkbox-3-3">
                <input type="checkbox" id="checkbox-3-3" style="margin-right: 0.5rem">Unable to Refresh Links Banner
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'UNABLE TO REFRESH. We couldn't get updated values from a linked workbook.'<br>This pop-up sometimes appears when external workbooks cannot be reached.<br><br>Check to auto-close (ignore and close the dialog).</div>
                </div>
            </label>
        </div>
        <div class="row" id="row-3-4">
            <label for="checkbox-3-4">
                <input type="checkbox" id="checkbox-3-4" style="margin-right: 0.5rem">Microsoft 365 Access Banner
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Allow access to Microsoft 365 account. Your browser settings are preventing an optimal experience with Microsoft 365. Allow access to improve your experience.'<br><br>Check to auto-close (ignore and close the dialog).</div>
                </div>
            </label>
        </div> -->
        <div class="row" id="new-row-3" style="display: flexbox; float:left;">
            <button id="new-save-button-3" class="add-button" title="Save New Row">+</button>
            <input type="text" id="new-name-3" placeholder="Name" style="width:15%">
            <input type="text" id="new-text-3" placeholder="Pop-Up Text" style="width:30%">
            <input type="text" id="new-label-3" placeholder="Button Label" style="width:30%">
            <div class="info-container">
                <div class="hoverable">ðŸ›ˆ</div>
                <div class="tooltip">Name: Input the name you would like to label this item as.<br><br>Pop-Up Text: Text which is visible on the pop-up. The extension will look for this text as an indication that the pop-up has appeared.<br><br>Button Label: Exact text on the button that will be automatically clicked. The extension will look for a button with aria-label matching this. Most X's have aria-label="Close".<br><br>Saving: Press Enter to save, or press the "+" button to the left of your entry.</div>
            </div>
        </div>
        <div class="row" id="add-row-3">
            <label for="add-button-3" class="add-label">
                <button id="add-button-3" class="add-button" title="Add New Row" style="margin-right: 0.5rem">+</button>Add New Row
            </label>
        </div>
    </div>




    
    <div class="section 4" id="settings">
        <h3>Settings</h3>
        <!-- <div class="row" id="row-4-1">
            <label for="checkbox-4-1">
                <input type="checkbox" id="checkbox-4-1" style="margin-right: 0.5rem">Enable Desktop Notifications
            </label>
        </div> -->
        <div class="row" id="row-4-2">
            <a href="logs.html" target="_blank">View Logs</a>
        </div>
        <div class="row" id="row-4-3">
            <a href="https://github.com/JoshuaPHuang/Excel-Online-Notif-Suppressor-Extension" target="_blank">View Github Repository</a>
        </div>
        <div class="row" id="row-4-4">
            <a href="acknowledgments.html" target="_blank">View Acknowledgments</a>
        </div>
    </div>


    
    <script src="popup.js"></script>
</body>
</html>

<br><br><br><br><br><br><br><br>
ANYTHING BELOW THIS LINE SHOULD BE IGNORED; THESE ARE JUST NOTES
/*
Introduction?
- Explain that only elements found within the iframe can be removed; or? only the one that matches https://usc-excel.officeapps.live.com?
- Explain that this suppresses or removes dialogs
Dialog List of Checkboxes of things to kill
- RenamePromptCalloutHeader ('We have autosaved your file. Ready to name it?')
- @aria-label, 'Selected date' (Calendar pop-up which occurs after using Datestamp hotkey Ctrl+;.)
- KeyboardShortcutAwarenessCalloutCloseButton ('Your browser reserves some shortcuts. Find the list of alternatives here.')
- Editing session in progress (auto continues)
- Your session has expired, please reload to continue
- NEED TO ADD:
    - Allow access to Microsoft 365 account (auto allow or auto close)
    - Trust workbook links? (auto trust or auto close) (notify?)
    - "UNABLE TO REFRESH We couldn't get updated values from a linked workbook. Give Feedback" (auto close) (notify?)
    - Stay signed in (need to add back in)
    - "Need more working space? Looks like your display is not optimised. Toggle FullScreen to maximise screen space." (auto close)
        'Need more working space?'<br>'Looks like your display is not optimised.'<br>'Toggle FullScreen to maximise screen space.'
    - NEED TO ALSO ADD disable for the Ctrl options popup that occurs when pasting something
    - Frozen rows won't scroll
        'Frozen rows won't scroll'<br>'The visible area of your grid contains only frozen rows, which will not scroll. To scroll, unfreeze the rows, change the size of the Excel window, or zoom out.'
    - Someone has this workbook locked (Continue in reading view)
        popup updated already; need to add to js
    - We couldn't lock this file for editing/Someone has this workbook locked (No)
        'Can't Edit Workbook' OR 'Someone has this workbook locked'<br>'We're sorry. We couldn't lock this file for editing. Would you like to try again?'<br><br>Check to auto-select "No".






Additional Strings Section
- Have a plus sign to add additional strings to kill
- Each additional string should have a textbox, # layers to kill, 
- Need a blurb (question mark in a circle, popup?) to explain what this is and what the # of layers to kill means
- Need to store these values in Chrome local storage 


Settings Section
- Enable notifications checkbox
- View logs button
- View Github Repository
*/


