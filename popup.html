<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Pop-Up Blocker Popup</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <h2 style="white-space: pre-wrap; overflow-wrap: break-word; margin-top: -1rem; text-align: center;" id="title">Excel Online<br>Pop-Up Blocker</h2>
    <div class="section">This Extension suppresses annoying pop-ups in Excel Online.
        <div class="info-container" id="intro-hoverable">
            <div class="hoverable">ðŸ›ˆ</div>
            <div class="tooltip" id="intro-tooltip">Only dialogs contained in iframes with origin containing "https://*.<wbr>officeapps.<wbr>live.<wbr>com/" are suppressed.<br>To expand functionality to the overall page or to additional origins, please contact the developer.</div>
        </div>
    </div>
    <p>Select which pop-ups to block below!</p>
    

    <div class="section" id="blocked-pop-ups">
        <h3>Blocked Pop-Ups</h3>
        <div class="row" id="blocked-row-1">
            <label for="checkbox-1-1">
                <input type="checkbox" id="checkbox-1-1" style="margin-right: 0.5rem">Renaming Prompt
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'We have autosaved your file. Ready to name it?'<br><br>This pop-up sometimes appears when pressing Ctrl+S in Excel Online.</div>
                </div>
            </label>
        </div>
        <div class="row" id="blocked-row-2">
            <label for="checkbox-1-2">
                <input type="checkbox" id="checkbox-1-2" style="margin-right: 0.5rem">Calendar Pop-Up
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">This calendar blocks view of everything to the right of the current cell.<br><br>This pop-up appears when pressing Ctrl+; in Excel Online.</div>
                </div>
            </label>
        </div>
        <div class="row" id="blocked-row-3">
            <label for="checkbox-1-3">
                <input type="checkbox" id="checkbox-1-3" style="margin-right: 0.5rem">Reserved Shortcut Pop-Up
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Your browser reserves some shortcuts. Find the list of alternatives here.'<br><br>This pop-up sometimes appears when using hotkeys in Excel Online.</div>
                </div>
            </label>
        </div>
    </div>

    <div class="section" id="auto-approved-pop-ups">
        <h3>Auto-Approved Pop-Ups</h3>
        <div class="row" id="blocked-row-1">
            <label for="checkbox-2-1">
                <input type="checkbox" id="checkbox-2-1" style="margin-right: 0.5rem">Editing Session in Progress
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Editing session in progress'<br>'Other people are already editing this workbook. You can join their editing session, but you will lose any changes you have made so far. Would you like to join the existing editing session anyway?'<br><br>Check to auto-select 'Yes'.</div>
                </div>
            </label>
        </div>
        <div class="row" id="blocked-row-2">
            <label for="checkbox-2-2">
                <input type="checkbox" id="checkbox-2-2" style="margin-right: 0.5rem">Workbook Locked
                <div class="info-container">
                    <div class="hoverable">ðŸ›ˆ</div>
                    <div class="tooltip">'Someone has this workbook locked'<br>'_ has locked this file for editing. This may happen if they're using a non-subscription version of Excel. Ask them to close the file or check it in.'<br><br>Check to auto-select 'Continue in reading view'.</div>
                </div>
            </label>
        </div>
    </div>

    <h3>Additional Blocked Strings</h3>
    
    <h3>Settings</h3>


    <p>â€”Joshua Huang</p>
    <p id="github-txt">View <a href="https://github.com/JoshuaPHuang/Excel-Online-Notif-Suppressor-Extension.git" target="_blank">GitHub Repository</a></p>
    
    <script src="popup.js"></script>
</body>
</html>

<div class="info-container" id="intro-hoverable">ðŸ›ˆ
    <div class="tooltip"></div>
</div>
 
/*
Introduction?
- Explain that only elements found within the iframe can be removed; or? only the one that matches https://usc-excel.officeapps.live.com?
- Explain that this suppresses or removes dialogs
Dialog List of Checkboxes of things to kill
- RenamePromptCalloutHeader ('We have autosaved your file. Ready to name it?')
- @aria-label, 'Selected date' (Calendar pop-up which occurs after using Datestamp hotkey Ctrl+;.)
- KeyboardShortcutAwarenessCalloutCloseButton ('Your browser reserves some shortcuts. Find the list of alternatives here.')
- Editing session in progress (auto continues)
- Someone has this workbook locked (auto disapprove)
- NEED TO ADD:
    - Your session has expired, please reload to continue
    - Allow access to Microsoft 365 account (auto allow or auto close)
    - Trust workbook links? (auto trust or auto close) (notify?)
    - "UNABLE TO REFRESH We couldn't get updated values from a linked workbook. Give Feedback" (auto close) (notify?)
    - Stay signed in (need to add back in)
    - "Need more working space? Looks like your display is not optimised. Toggle FullScreen to maximise screen space." (auto close)



Additional Strings Section
- Have a plus sign to add additional strings to kill
- Each additional string should have a textbox, # layers to kill, 
- Need a blurb (question mark in a circle, popup?) to explain what this is and what the # of layers to kill means
- Need to store these values in Chrome local storage 


Settings Section
- Enable notifications checkbox
- View logs button
- View Github Repository
*/


